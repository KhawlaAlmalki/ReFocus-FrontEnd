### Test Coach Verification Workflow (Admin)

### SETUP: Create test users and applications first

### 1. Register a user who will apply to be a coach
POST http://localhost:5050/api/auth/register
Content-Type: application/json

{
  "name": "John Coach",
  "email": "john.coach@example.com",
  "password": "password123"
}

### 2. Login as the applicant to get token
POST http://localhost:5050/api/auth/login
Content-Type: application/json

{
  "email": "john.coach@example.com",
  "password": "password123"
}

### Save the token from step 2 and use it below
@applicantToken = YOUR_APPLICANT_TOKEN_HERE

### 3. Submit coach application
POST http://localhost:5050/api/coach/apply
Content-Type: application/json
Authorization: Bearer {{applicantToken}}

{
  "expertise": ["Productivity", "Time Management", "Focus Techniques"],
  "bio": "I am a certified productivity coach with over 5 years of experience helping individuals and teams achieve their goals. My approach focuses on sustainable habits and practical strategies that work in real-world scenarios.",
  "experience": "I have worked with over 100 clients from various industries, helping them improve their productivity and focus. I hold certifications in coaching and have authored several articles on time management.",
  "certifications": [
    {
      "name": "Certified Professional Coach",
      "issuer": "International Coach Federation",
      "year": 2019,
      "certificateUrl": "https://example.com/cert1.pdf"
    },
    {
      "name": "Productivity Specialist",
      "issuer": "Productivity Institute",
      "year": 2020,
      "certificateUrl": "https://example.com/cert2.pdf"
    }
  ],
  "socialLinks": {
    "linkedin": "https://linkedin.com/in/johncoach",
    "website": "https://johncoach.com",
    "twitter": "https://twitter.com/johncoach"
  }
}

### 4. Check application status (as applicant)
GET http://localhost:5050/api/coach/my-application
Authorization: Bearer {{applicantToken}}

### === ADMIN VERIFICATION WORKFLOW ===

### 5. Login as admin
POST http://localhost:5050/api/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "admin123"
}

### Save the admin token from step 5
@adminToken = YOUR_ADMIN_TOKEN_HERE

### 6. Get all pending applications (Admin)
GET http://localhost:5050/api/coach/applications?status=pending
Authorization: Bearer {{adminToken}}

### 7. Get all applications regardless of status (Admin)
GET http://localhost:5050/api/coach/applications
Authorization: Bearer {{adminToken}}

### 8. Approve a specific application (Admin)
### Replace APPLICATION_ID with the actual ID from step 6
PUT http://localhost:5050/api/coach/applications/APPLICATION_ID_HERE/approve
Authorization: Bearer {{adminToken}}

### 9. Reject a specific application (Admin) - Alternative to step 8
### Replace APPLICATION_ID with the actual ID from step 6
PUT http://localhost:5050/api/coach/applications/APPLICATION_ID_HERE/reject
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "rejectionReason": "Insufficient coaching experience. Please reapply after completing additional certifications and gaining more client experience.",
  "adminNotes": "Good application overall, but needs more documented experience. Encourage to reapply in 6 months."
}

### === POST-APPROVAL WORKFLOW ===

### 10. Check approved applications (Admin)
GET http://localhost:5050/api/coach/applications?status=approved
Authorization: Bearer {{adminToken}}

### 11. Check rejected applications (Admin)
GET http://localhost:5050/api/coach/applications?status=rejected
Authorization: Bearer {{adminToken}}

### 12. Applicant checks their profile after approval
GET http://localhost:5050/api/users/profile
Authorization: Bearer {{applicantToken}}

### 13. Applicant accesses their coach profile (after approval)
GET http://localhost:5050/api/coach/my-profile
Authorization: Bearer {{applicantToken}}

### 14. Get all public coach profiles
GET http://localhost:5050/api/coach/profiles

### 15. Update coach profile (after approval)
PUT http://localhost:5050/api/coach/my-profile
Content-Type: application/json
Authorization: Bearer {{applicantToken}}

{
  "isAvailable": true,
  "maxMentees": 10,
  "isPubliclyVisible": true,
  "bio": "Updated bio: Experienced productivity coach helping professionals achieve their goals through proven strategies."
}

### === ERROR SCENARIOS ===

### 16. Try to approve already reviewed application (should fail)
PUT http://localhost:5050/api/coach/applications/APPLICATION_ID_HERE/approve
Authorization: Bearer {{adminToken}}

### 17. Try to reject without reason (should fail)
PUT http://localhost:5050/api/coach/applications/APPLICATION_ID_HERE/reject
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "adminNotes": "Some notes without rejection reason"
}

### 18. Try to access admin routes without admin role (should fail)
GET http://localhost:5050/api/coach/applications
Authorization: Bearer {{applicantToken}}

### 19. Try to approve as non-admin (should fail)
PUT http://localhost:5050/api/coach/applications/APPLICATION_ID_HERE/approve
Authorization: Bearer {{applicantToken}}

### === WORKFLOW VALIDATION ===

### 20. Verify applicant received email notifications
### Check server console logs for email preview URLs

### 21. Test duplicate application (should fail)
POST http://localhost:5050/api/coach/apply
Content-Type: application/json
Authorization: Bearer {{applicantToken}}

{
  "expertise": ["Productivity"],
  "bio": "Another bio that meets the minimum 100 character requirement for the coach application. This is just a test to verify duplicate applications are prevented.",
  "experience": "More experience description to meet the 50 character minimum requirement."
}

### === ADDITIONAL TEST CASES ===

### 22. Create another applicant for bulk testing
POST http://localhost:5050/api/auth/register
Content-Type: application/json

{
  "name": "Sarah Mentor",
  "email": "sarah.mentor@example.com",
  "password": "password123"
}

### 23. Login as second applicant
POST http://localhost:5050/api/auth/login
Content-Type: application/json

{
  "email": "sarah.mentor@example.com",
  "password": "password123"
}

@applicant2Token = YOUR_SECOND_APPLICANT_TOKEN_HERE

### 24. Submit second application
POST http://localhost:5050/api/coach/apply
Content-Type: application/json
Authorization: Bearer {{applicant2Token}}

{
  "expertise": ["Mindfulness", "Stress Management"],
  "bio": "Certified mindfulness coach with a passion for helping people find balance and focus. I specialize in stress management techniques and meditation practices that enhance productivity and well-being.",
  "experience": "Worked with corporate clients and individuals for the past 3 years, specializing in mindfulness-based stress reduction."
}

### 25. Verify admin can see both pending applications
GET http://localhost:5050/api/coach/applications?status=pending
Authorization: Bearer {{adminToken}}
